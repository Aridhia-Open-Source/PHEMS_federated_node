python_logs:
  managed_python_loggers:
    - root
  dagster_handler_config:
    handlers:
      stdout:
        class: logging.StreamHandler
        level: INFO
        stream: ext://sys.stdout
      stderr:
        class: logging.StreamHandler
        level: ERROR
        stream: ext://sys.stderr

storage:
  postgres:
    postgres_db:
      db_name: test
      username: test
      password:
        env: DAGSTER_PG_PASSWORD
      hostname: fn-dev-postgresql
      port: 5432

run_monitoring:
  enabled: true
  start_timeout_seconds: 180
  cancel_timeout_seconds: 180
  max_resume_run_attempts: 0
  poll_interval_seconds: 60

# compute_logs:
#   module: app.logger
#   class: S3ComputeLogManagerExtended
#   config:
#     endpoint_url: http://minio:9000
#     region: us-east-1
#     bucket: dagster
#     prefix: logs
#     use_ssl: false
#     verify: false
#     upload_interval: 10
#     access_key:
#       env: DAGSTER_MINIO_ACCESS_KEY
#     secret_key:
#       env: DAGSTER_MINIO_SECRET_KEY

run_launcher:
  module: dagster_celery_k8s.launcher
  class: CeleryK8sRunLauncher
  config:
    dagster_home: /opt/dagster/home
    job_namespace: fn
    load_incluster_config: true

    broker:
      env: DAGSTER_CELERY_BROKER_URL
    backend:
      env: DAGSTER_CELERY_BACKEND_URL

    env_config_maps:
      - dagster-env-config

    volumes:
      - name: artifacts-pvc
        persistentVolumeClaim:
          claimName: artifacts-pvc

    volume_mounts:
      - name: artifacts-pvc
        mountPath: /mnt/dagster/artifacts
